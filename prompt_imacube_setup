##
# imacube prompt theme adapted from zsh adam2 and kali-linux docker image
##

prompt_imacube_help () {
  cat <<'EOF'
This prompt is adapated from zsh adam2

  prompt imacube

EOF
}

prompt_imacube_setup () {
  # Some can't be local
  setopt localoptions nowarncreateglobal
  local prompt_gfx_tlc prompt_gfx_mlc prompt_gfx_blc

  prompt_gfx_tlc='.'
  prompt_gfx_mlc='|'
  prompt_gfx_blc='\`'
  prompt_gfx_hyphen='─'

  # Colour scheme
  prompt_imacube_color1='green'    # hyphens
  prompt_imacube_color2='white'   # current directory
  prompt_imacube_color3='blue'   # user@host
  prompt_imacube_color4='white'   # user input

  local prompt_gfx_bbox 
  prompt_gfx_tbox="%F{$prompt_imacube_color1}┌%F{$prompt_imacube_color1}${prompt_gfx_hyphen}"
  prompt_gfx_bbox="%F{$prompt_imacube_color1}└${prompt_gfx_hyphen}%b%F{$prompt_imacube_color1}"

  prompt_l_paren="%b%F{green}("
  prompt_r_paren="%b%F{green})"
  prompt_l_brace="%b%F{cyan}["
  prompt_r_brace="%b%F{cyan}]"

  prompt_user_host="%B%F{$prompt_imacube_color3}%n%F{$prompt_imacube_color3}@%F{$prompt_imacube_color3}%m"

  prompt_line_1a="$prompt_gfx_tbox$prompt_l_paren%B%F{$prompt_imacube_color2}$prompt_user_host$prompt_r_paren%b%F{$prompt_imacube_color1}"
  prompt_line_1b="$prompt_l_brace%B%F{white}%~$prompt_r_brace%b%F{$prompt_imacube_color1}"

  prompt_line_2="$prompt_gfx_bbox${prompt_gfx_hyphen}%b%F{white}"

  prompt_char="%(!.#.>)"

  prompt_opts=(cr subst percent)

  add-zsh-hook precmd prompt_imacube_precmd
}

prompt_imacube_precmd() {
  setopt localoptions extendedglob noxtrace nowarncreateglobal
  local prompt_line_1

  prompt_imacube_choose_prompt

  PS1="$prompt_line_1$prompt_newline$prompt_line_2%B%F{white}$prompt_char %b%f%k"
  zle_highlight[(r)default:*]="default:fg=$prompt_imacube_color4"
}

prompt_imacube_choose_prompt () {
  prompt_line_1="${prompt_line_1a}-${prompt_line_1b}"
}

prompt_imacube_setup "$@"
